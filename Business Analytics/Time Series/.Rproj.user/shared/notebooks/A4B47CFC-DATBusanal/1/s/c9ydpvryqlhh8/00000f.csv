"0","# --- Setup ---"
"0","# Get last 3 actual values from the dataset to serve as lags"
"0","last_obs <- tail(fuel_data, 3)"
"0",""
"0","# Create input frame for preprocessing with dummy avg_price column (required by preproc)"
"0","future_lags <- data.frame("
"0","  avg_price = 0,"
"0","  lag_1 = last_obs$avg_price[3],"
"0","  lag_2 = last_obs$avg_price[2],"
"0","  lag_3 = last_obs$avg_price[1]"
"0",")"
"0",""
"0","# Scale lagged inputs"
"0","future_scaled <- predict(preproc, future_lags)"
"0","current_input <- as.numeric(future_scaled[, c(""lag_1"", ""lag_2"", ""lag_3"")])"
"0",""
"0","# Forecast Loop"
"0","future_preds <- c()"
"0","for (i in 1:15) {"
"0","  # Predict next value using SVR"
"0","  pred_scaled <- predict(svr_model, as.data.frame(t(current_input)))"
"0","  # Inverse scaling"
"0","  pred_rescaled <- pred_scaled * preproc$std[""avg_price""] + preproc$mean[""avg_price""]"
"0","  future_preds <- c(future_preds, pred_rescaled)"
"0","  "
"0","  # Update lags (rolling forecast)"
"0","  current_input <- c(pred_scaled, current_input[1:2])"
"0","}"
"0",""
"0","# Format Output"
"0","future_dates <- seq(max(fuel_data$Date) + 7, by = 7, length.out = 15)"
"0","svr_forecast_15 <- data.frame(Date = future_dates, SVR_Prediction = round(future_preds, 2))"
"0",""
"0","# Display forecast table"
"0","knitr::kable(svr_forecast_15, caption = ""15-Week Ahead Forecast â€“ SVR (Linear)"")"
"2","Warning: 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help(""Deprecated"")"
