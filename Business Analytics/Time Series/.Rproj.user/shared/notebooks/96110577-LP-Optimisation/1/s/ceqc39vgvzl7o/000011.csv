"0","# Create risk-adjusted delivery factor"
"0","opt_data <- opt_data %>%"
"0","  mutate("
"0","    Transport_Risk = case_when("
"0","      `Transportation modes` == ""Air""  ~ 1,"
"0","      `Transportation modes` == ""Road"" ~ 2,"
"0","      `Transportation modes` == ""Rail"" ~ 3,"
"0","      TRUE ~ 2"
"0","    ),"
"0","    Inspection_Fail = ifelse(`Inspection results` == ""Fail"", 1, 0),"
"0","    Risk_Score = 0.5 * `Defect rates` + 0.3 * Inspection_Fail + 0.2 * Transport_Risk,"
"0","    Risk_Adjusted_Efficiency = (1 - Risk_Score),"
"0","    SKU_ID = as.integer(factor(SKU)),"
"0","    Supplier_ID = as.integer(factor(`Supplier name`))"
"0","  )"
"0",""
"0","opt_df <- opt_data %>%"
"0","  select(SKU, SKU_ID, Supplier = `Supplier name`, Supplier_ID, Route = Routes,"
"0","         Cost = Costs, Quantity = `Order quantities`, Risk_Score, Risk_Adjusted_Efficiency)"
"0",""
"0","head(opt_df)"
